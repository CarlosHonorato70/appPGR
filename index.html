<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Exportação Local - Exemplo jsPDF, html2pdf, xlsx</title>
  <!-- Bibliotecas JS locais -->
  <script src="libs/jspdf.umd.min.js"></script>
  <script src="libs/html2pdf.bundle.min.js"></script>
  <script src="libs/xlsx.full.min.js"></script>
</head>
<body>
  <h1>Exportação Local - Exemplo jsPDF, html2pdf, xlsx</h1>

  <button id="btn-pdf">Exportar PDF (jsPDF)</button>
  <button id="btn-html2pdf">Exportar PDF (html2pdf)</button>
  <button id="btn-xlsx">Exportar XLSX</button>

  <div id="conteudo" style="margin-top:20px; border:1px solid #ccc; padding:10px;">
    <h2>Conteúdo para Exportação</h2>
    <p>Este é um exemplo de conteúdo que pode ser exportado.</p>
    <ul>
      <li>Item 1</li>
      <li>Item 2</li>
      <li>Item 3</li>
    </ul>
  </div>

  <script>
    // jsPDF - PDF simples
    document.getElementById('btn-pdf').onclick = function() {
      if (typeof jsPDF !== 'undefined') {
        const doc = new jsPDF();
        doc.text('Exportado com jsPDF!', 10, 10);
        doc.save('exemplo-jsPDF.pdf');
      } else {
        alert('jsPDF não está disponível. Esta implementação usa fallback para impressão.');
        window.print();
      }
    };

    // html2pdf - exporta div para PDF
    document.getElementById('btn-html2pdf').onclick = function() {
      if (typeof html2pdf !== 'undefined') {
        const elemento = document.getElementById('conteudo');
        html2pdf().from(elemento).set({filename: 'exemplo-html2pdf.pdf'}).save();
      } else {
        alert('html2pdf não está disponível. Esta implementação usa fallback para impressão.');
        window.print();
      }
    };

    // XLSX - exporta tabela simples
    document.getElementById('btn-xlsx').onclick = function() {
      if (typeof XLSX !== 'undefined') {
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.aoa_to_sheet([
          ['Nome', 'Idade'],
          ['Carlos', 30],
          ['Maria', 25]
        ]);
        XLSX.utils.book_append_sheet(wb, ws, 'Pessoas');
        XLSX.writeFile(wb, 'exemplo.xlsx');
      } else {
        alert('XLSX não está disponível.');
      }
    };
  </script>
</body>
</html>