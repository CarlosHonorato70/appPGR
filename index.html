<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Gest√£o de PGR</title>
    <!-- Link para o arquivo de estilos CSS -->
    <link rel="stylesheet" href="./style.css">
    <!-- Bibliotecas para exporta√ß√£o de relat√≥rios - com fallbacks -->
    <script>
        // Fallbacks para quando as bibliotecas CDN n√£o est√£o dispon√≠veis
        window.exportFallbacks = {
            // Simple PDF export using print functionality
            exportToPDF: function(element, filename) {
                const originalTitle = document.title;
                document.title = filename;
                window.print();
                document.title = originalTitle;
            },
            
            // Simple CSV export
            exportToCSV: function(data, filename) {
                let csv = '';
                data.forEach(row => {
                    csv += row.join(',') + '\n';
                });
                
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.click();
                window.URL.revokeObjectURL(url);
            }
        };
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <header>
        <h1>Sistema de Gest√£o de PGR</h1>
        <p>Gerencie e monitore o Programa de Gerenciamento de Riscos (PGR) em conformidade com a NR-01.</p>
    </header>

    <!-- Login Modal -->
    <div id="login-modal" class="modal-overlay">
        <div class="modal-content">
            <h2>Login - Sistema PGR</h2>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Usu√°rio:</label>
                    <input type="text" id="username" required placeholder="Digite seu usu√°rio">
                </div>
                <div class="form-group">
                    <label for="password">Senha:</label>
                    <input type="password" id="password" required placeholder="Digite sua senha">
                </div>
                <button type="submit">Entrar</button>
                <p class="login-info">Usu√°rio padr√£o: admin / Senha: admin123</p>
            </form>
        </div>
    </div>

    <div class="main-container" id="main-app" style="display: none;">
        <nav>
            <div class="user-info">
                <span>Usu√°rio: <span id="current-user">Admin</span></span>
                <button id="logout-btn" class="logout-btn">Sair</button>
            </div>
            <ul>
                <li><a href="#dashboard" class="nav-link active">Dashboard</a></li>
                <li><a href="#gestao-unidades" class="nav-link">Gest√£o de Unidades</a></li>
                <li><a href="#checklist-pgr" class="nav-link">Checklist Interativo do PGR</a></li>
                <li><a href="#inventario-riscos" class="nav-link">Invent√°rio de Riscos</a></li>
                <li><a href="#plano-acao" class="nav-link">Plano de A√ß√£o</a></li>
                <li><a href="#gestao-documentos" class="nav-link">Gest√£o de Documentos</a></li>
                <li><a href="#relatorios-dashboards" class="nav-link">Relat√≥rios e Dashboards</a></li>
                <li><a href="#notificacoes" class="nav-link">Notifica√ß√µes</a></li>
                <li><a href="#perfis-usuario" class="nav-link">Perfis de Usu√°rio</a></li>
            </ul>
        </nav>

        <main>
            <!-- 1. Dashboard -->
            <section id="dashboard" class="content-section active">
                <h2>Dashboard</h2>
                <p>Bem-vindo(a) ao seu painel de controle do PGR. Aqui voc√™ tem uma vis√£o geral r√°pida do status atual e dos pontos cr√≠ticos.</p>
                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h4>Status Geral do PGR</h4>
                        <p class="status-badge status-verified" id="dashboard-status-geral">Conforme</p>
                    </div>
                    <div class="dashboard-card">
                        <h4>Riscos Cr√≠ticos Identificados</h4>
                        <p id="dashboard-riscos-criticos">0</p>
                    </div>
                    <div class="dashboard-card">
                        <h4>A√ß√µes Pendentes</h4>
                        <p id="dashboard-acoes-pendentes">0</p>
                    </div>
                    <div class="dashboard-card">
                        <h4>Conformidade NR-01</h4>
                        <p id="dashboard-conformidade">0%</p>
                    </div>
                </div>
                <h3>Vis√£o R√°pida dos Pr√≥ximos Prazos</h3>
                <table id="dashboard-prazos-table">
                    <thead>
                        <tr>
                            <th>A√ß√£o</th>
                            <th>Prazo</th>
                            <th>Respons√°vel</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados carregados via JS -->
                    </tbody>
                </table>
            </section>

            <!-- 2. Gest√£o de Unidades -->
            <section id="gestao-unidades" class="content-section">
                <h2>Gest√£o de Unidades</h2>
                <p>Aqui voc√™ pode cadastrar e gerenciar os dados de identifica√ß√£o das unidades de trabalho.</p>
                <h3>Cadastrar Nova Unidade</h3>
                <form id="form-unidade">
                    <div class="form-group">
                        <label for="nomeUnidade">Nome da Unidade:</label>
                        <input type="text" id="nomeUnidade" name="nomeUnidade" placeholder="Ex: Unidade Central" required>
                    </div>
                    <div class="form-group">
                        <label for="cnpjUnidade">CNPJ/CPF:</label>
                        <input type="text" id="cnpjUnidade" name="cnpjUnidade" placeholder="00.000.000/0000-00 ou CPF" required>
                    </div>
                    <div class="form-group">
                        <label for="enderecoUnidade">Endere√ßo:</label>
                        <input type="text" id="enderecoUnidade" name="enderecoUnidade" placeholder="Rua Exemplo, 123" required>
                    </div>
                    <div class="form-group">
                        <label for="responsavelLegalUnidade">Respons√°vel Legal:</label>
                        <input type="text" id="responsavelLegalUnidade" name="responsavelLegalUnidade" placeholder="Nome Completo do Respons√°vel" required>
                    </div>
                    <div class="form-group">
                        <label for="contatoUnidade">Telefone/Email:</label>
                        <input type="text" id="contatoUnidade" name="contatoUnidade" placeholder="(00) 90000-0000 / email@exemplo.com">
                    </div>
                    <button type="submit">Cadastrar Unidade</button>
                </form>
                <h3>Unidades Cadastradas</h3>
                <table id="unidades-cadastradas-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>CNPJ/CPF</th>
                            <th>Respons√°vel</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados carregados via JS -->
                    </tbody>
                </table>
            </section>

            <!-- 3. Checklist Interativo do PGR -->
            <section id="checklist-pgr" class="content-section">
                <h2>Checklist Interativo do PGR</h2>
                <p>Monitore os itens do Programa de Gerenciamento de Riscos.</p>
                <table id="checklist-table">
                    <thead>
                        <tr>
                            <th>Item do Checklist</th>
                            <th>Status</th>
                            <th>Evid√™ncias</th>
                            <th>Respons√°vel</th>
                            <th>Prazo</th>
                            <th>N√≠vel de Risco</th>
                            <th>Medidas de Controle</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Itens do checklist ser√£o carregados/adicionados via JS -->
                    </tbody>
                </table>
                <button id="add-checklist-item">Adicionar Novo Item ao Checklist</button>
            </section>

            <!-- 4. Invent√°rio de Riscos -->
            <section id="inventario-riscos" class="content-section">
                <h2>Invent√°rio de Riscos</h2>
                <p>Detalhe e avalie os riscos presentes no ambiente de trabalho.</p>
                
                <h3>Riscos F√≠sicos</h3>
                <form id="form-riscos-fisicos">
                    <div class="form-group"><label for="tipoRiscoFisico">Tipo de Risco:</label><input type="text" id="tipoRiscoFisico" placeholder="Ex: Ru√≠do, Vibra√ß√£o"></div>
                    <div class="form-group"><label for="fonteRiscoFisico">Fonte:</label><input type="text" id="fonteRiscoFisico" placeholder="Ex: Compressor"></div>
                    <div class="form-group"><label for="exposicaoFisico">N√≠vel de Exposi√ß√£o:</label><input type="text" id="exposicaoFisico" placeholder="Ex: 85 dB (A)"></div>
                    <div class="form-group"><label for="medidasControleFisico">Medidas de Controle:</label><textarea id="medidasControleFisico" placeholder="Ex: Protetor auricular"></textarea></div>
                    <button type="submit">Adicionar Risco F√≠sico</button>
                </form>
                <table id="riscos-fisicos-table">
                    <thead><tr><th>Tipo</th><th>Fonte</th><th>Exposi√ß√£o</th><th>Controle</th><th>A√ß√µes</th></tr></thead>
                    <tbody></tbody>
                </table>

                <h3>Riscos Qu√≠micos</h3>
                <form id="form-riscos-quimicos">
                    <div class="form-group"><label for="tipoRiscoQuimico">Subst√¢ncia:</label><input type="text" id="tipoRiscoQuimico" placeholder="Ex: Merc√∫rio, Resinas"></div>
                    <div class="form-group"><label for="localRiscoQuimico">Local de Uso:</label><input type="text" id="localRiscoQuimico" placeholder="Ex: Sala de manipula√ß√£o"></div>
                    <div class="form-group"><label for="medidasControleQuimico">Medidas de Controle:</label><textarea id="medidasControleQuimico" placeholder="Ex: Ventila√ß√£o, EPIs"></textarea></div>
                    <button type="submit">Adicionar Risco Qu√≠mico</button>
                </form>
                <table id="riscos-quimicos-table">
                    <thead><tr><th>Subst√¢ncia</th><th>Local</th><th>Controle</th><th>A√ß√µes</th></tr></thead>
                    <tbody></tbody>
                </table>

                <h3>Riscos Biol√≥gicos</h3>
                <form id="form-riscos-biologicos">
                    <div class="form-group"><label for="agenteRiscoBiologico">Agente:</label><input type="text" id="agenteRiscoBiologico" placeholder="Ex: V√≠rus, Bact√©rias"></div>
                    <div class="form-group"><label for="tarefaRiscoBiologico">Tarefas de Risco:</label><input type="text" id="tarefaRiscoBiologico" placeholder="Ex: Manuseio de instrumentos"></div>
                    <div class="form-group"><label for="medidasControleBiologico">Medidas de Controle:</label><textarea id="medidasControleBiologico" placeholder="Ex: Esteriliza√ß√£o, Vacina√ß√£o"></textarea></div>
                    <button type="submit">Adicionar Risco Biol√≥gico</button>
                </form>
                <table id="riscos-biologicos-table">
                    <thead><tr><th>Agente</th><th>Tarefas</th><th>Controle</th><th>A√ß√µes</th></tr></thead>
                    <tbody></tbody>
                </table>

                <h3>Riscos Ergon√¥micos</h3>
                <form id="form-riscos-ergonomicos">
                    <div class="form-group"><label for="tipoRiscoErgonomico">Tipo:</label><input type="text" id="tipoRiscoErgonomico" placeholder="Ex: Postura inadequada"></div>
                    <div class="form-group"><label for="atividadeRiscoErgonomico">Atividade:</label><input type="text" id="atividadeRiscoErgonomico" placeholder="Ex: Procedimentos longos"></div>
                    <div class="form-group"><label for="medidasControleErgonomico">Medidas de Controle:</label><textarea id="medidasControleErgonomico" placeholder="Ex: Cadeiras ergon√¥micas, pausas"></textarea></div>
                    <button type="submit">Adicionar Risco Ergon√¥mico</button>
                </form>
                <table id="riscos-ergonomicos-table">
                    <thead><tr><th>Tipo</th><th>Atividade</th><th>Controle</th><th>A√ß√µes</th></tr></thead>
                    <tbody></tbody>
                </table>

                <h3>Riscos de Acidentes</h3>
                <form id="form-riscos-acidentes">
                    <div class="form-group"><label for="tipoRiscoAcidente">Tipo:</label><input type="text" id="tipoRiscoAcidente" placeholder="Ex: Quedas, Choque el√©trico"></div>
                    <div class="form-group"><label for="localRiscoAcidente">Local/Causa:</label><input type="text" id="localRiscoAcidente" placeholder="Ex: Pisos molhados, fia√ß√£o"></div>
                    <div class="form-group"><label for="medidasControleAcidente">Medidas de Controle:</label><textarea id="medidasControleAcidente" placeholder="Ex: Sinaliza√ß√£o, manuten√ß√£o"></textarea></div>
                    <button type="submit">Adicionar Risco de Acidente</button>
                </form>
                <table id="riscos-acidentes-table">
                    <thead><tr><th>Tipo</th><th>Local/Causa</th><th>Controle</th><th>A√ß√µes</th></tr></thead>
                    <tbody></tbody>
                </table>

                <h3>Riscos Psicossociais</h3>
                <form id="form-riscos-psicossociais">
                    <div class="form-group">
                        <label for="fatorRiscoPsicossocial">Fator de Risco:</label>
                        <input type="text" id="fatorRiscoPsicossocial" name="fatorRiscoPsicossocial" placeholder="Ex: Excesso de trabalho, Ass√©dio, Estresse">
                    </div>
                    <div class="form-group">
                        <label for="fonteRiscoPsicossocial">Fonte/Causa:</label>
                        <input type="text" id="fonteRiscoPsicossocial" name="fonteRiscoPsicossocial" placeholder="Ex: Metas irrealistas, Falta de autonomia, Conflitos interpessoais">
                    </div>
                    <div class="form-group">
                        <label for="medidasControlePsicossocial">Medidas de Controle Existentes:</label>
                        <textarea id="medidasControlePsicossocial" name="medidasControlePsicossocial" placeholder="Ex: Canal de den√∫ncias, Pesquisa de clima, Programas de bem-estar"></textarea>
                    </div>
                    <button type="submit">Adicionar Risco Psicossocial</button>
                </form>
                <table id="riscos-psicossociais-table">
                    <thead>
                        <tr>
                            <th>Fator de Risco</th>
                            <th>Fonte/Causa</th>
                            <th>Medidas de Controle</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Riscos Psicossociais carregados via JS -->
                    </tbody>
                </table>
            </section>

            <!-- 5. Plano de A√ß√£o -->
            <section id="plano-acao" class="content-section">
                <h2>Plano de A√ß√£o</h2>
                <p>Acompanhe o status e os prazos das a√ß√µes para itens pendentes ou de alto risco.</p>
                <h3>Adicionar Nova A√ß√£o</h3>
                <form id="form-plano-acao">
                    <div class="form-group"><label for="descricaoAcao">Descri√ß√£o da A√ß√£o:</label><textarea id="descricaoAcao" required></textarea></div>
                    <div class="form-group"><label for="responsavelAcao">Respons√°vel:</label><input type="text" id="responsavelAcao" required></div>
                    <div class="form-group"><label for="prazoAcao">Prazo Final:</label><input type="date" id="prazoAcao" required></div>
                    <div class="form-group">
                        <label for="statusAcao">Status:</label>
                        <select id="statusAcao">
                            <option value="pendente">Pendente</option>
                            <option value="em-progresso">Em Progresso</option>
                            <option value="concluido">Conclu√≠do</option>
                            <option value="atrasado">Atrasado</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="nivelRiscoAssociado">N√≠vel de Risco Associado:</label>
                        <select id="nivelRiscoAssociado">
                            <option value="baixo">Baixo</option>
                            <option value="medio">M√©dio</option>
                            <option value="alto">Alto</option>
                        </select>
                    </div>
                    <button type="submit">Adicionar A√ß√£o</button>
                </form>
                <h3>A√ß√µes Registradas</h3>
                <table id="acoes-registradas-table">
                    <thead>
                        <tr>
                            <th>Descri√ß√£o</th>
                            <th>Respons√°vel</th>
                            <th>Prazo</th>
                            <th>Status</th>
                            <th>Risco Associado</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados carregados via JS -->
                    </tbody>
                </table>
            </section>

            <!-- 6. Gest√£o de Documentos -->
            <section id="gestao-documentos" class="content-section">
                <h2>Gest√£o de Documentos</h2>
                <p>Fa√ßa o upload e armazene documentos importantes como laudos, atestados e fichas.</p>
                <h3>Upload de Documentos</h3>
                <form id="form-documentos">
                    <div class="form-group">
                        <label for="tipoDocumento">Tipo de Documento:</label>
                        <select id="tipoDocumento">
                            <option value="ltcat">LTCAT</option>
                            <option value="pcmso">PCMSO</option>
                            <option value="ppr">PPR</option>
                            <option value="aso">ASO</option>
                            <option value="epi">Ficha de EPI</option>
                            <option value="outro">Outro</option>
                        </select>
                    </div>
                    <div class="form-group"><label for="nomeDocumento">Nome/T√≠tulo:</label><input type="text" id="nomeDocumento" placeholder="Ex: LTCAT 2024"></div>
                    <div class="form-group"><label for="dataEmissaoDoc">Data de Emiss√£o:</label><input type="date" id="dataEmissaoDoc"></div>
                    <div class="form-group"><label for="arquivoDocumento">Arquivo:</label><input type="file" id="arquivoDocumento" accept=".pdf,.doc,.docx,.jpg,.png" required></div>
                    <button type="submit">Realizar Upload</button>
                </form>
                <h3>Documentos Armazenados</h3>
                <table id="documentos-armazenados-table">
                    <thead>
                        <tr>
                            <th>Tipo</th>
                            <th>T√≠tulo</th>
                            <th>Data de Emiss√£o</th>
                            <th>Tamanho</th>
                            <th>A√ß√µes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Dados carregados via JS -->
                    </tbody>
                </table>
            </section>

            <!-- 7. Relat√≥rios e Dashboards -->
            <section id="relatorios-dashboards" class="content-section">
                <h2>Relat√≥rios e Dashboards</h2>
                <p>Visualize o status do PGR, identifique riscos cr√≠ticos e acompanhe o progresso do plano de a√ß√£o.</p>
                
                <div class="report-actions">
                    <h3>Exportar Relat√≥rios</h3>
                    <div class="export-buttons">
                        <button id="export-pdf" class="export-btn">
                            <span>üìÑ</span> Exportar Relat√≥rio Completo (PDF)
                        </button>
                        <button id="export-excel" class="export-btn">
                            <span>üìä</span> Exportar Dados (Excel)
                        </button>
                        <button id="print-report" class="export-btn">
                            <span>üñ®Ô∏è</span> Imprimir Relat√≥rio
                        </button>
                    </div>
                </div>

                <div class="dashboard-summary" id="report-content">
                    <h3>Resumo Executivo do PGR</h3>
                    <div class="summary-grid">
                        <div class="summary-item">
                            <h4>Status Geral</h4>
                            <p class="status-value">Conforme</p>
                        </div>
                        <div class="summary-item">
                            <h4>Total de Riscos Identificados</h4>
                            <p class="status-value" id="total-riscos">0</p>
                        </div>
                        <div class="summary-item">
                            <h4>A√ß√µes Pendentes</h4>
                            <p class="status-value" id="total-acoes-pendentes">0</p>
                        </div>
                        <div class="summary-item">
                            <h4>Conformidade</h4>
                            <p class="status-value" id="percentual-conformidade">0%</p>
                        </div>
                    </div>

                    <h4>Riscos por Categoria</h4>
                    <table id="relatorio-riscos-tabela">
                        <thead>
                            <tr>
                                <th>Categoria</th>
                                <th>Quantidade</th>
                                <th>Alto Risco</th>
                                <th>M√©dio Risco</th>
                                <th>Baixo Risco</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>F√≠sicos</td>
                                <td id="count-fisicos">0</td>
                                <td id="alto-fisicos">0</td>
                                <td id="medio-fisicos">0</td>
                                <td id="baixo-fisicos">0</td>
                            </tr>
                            <tr>
                                <td>Qu√≠micos</td>
                                <td id="count-quimicos">0</td>
                                <td id="alto-quimicos">0</td>
                                <td id="medio-quimicos">0</td>
                                <td id="baixo-quimicos">0</td>
                            </tr>
                            <tr>
                                <td>Biol√≥gicos</td>
                                <td id="count-biologicos">0</td>
                                <td id="alto-biologicos">0</td>
                                <td id="medio-biologicos">0</td>
                                <td id="baixo-biologicos">0</td>
                            </tr>
                            <tr>
                                <td>Ergon√¥micos</td>
                                <td id="count-ergonomicos">0</td>
                                <td id="alto-ergonomicos">0</td>
                                <td id="medio-ergonomicos">0</td>
                                <td id="baixo-ergonomicos">0</td>
                            </tr>
                            <tr>
                                <td>Acidentes</td>
                                <td id="count-acidentes">0</td>
                                <td id="alto-acidentes">0</td>
                                <td id="medio-acidentes">0</td>
                                <td id="baixo-acidentes">0</td>
                            </tr>
                            <tr>
                                <td>Psicossociais</td>
                                <td id="count-psicossociais">0</td>
                                <td id="alto-psicossociais">0</td>
                                <td id="medio-psicossociais">0</td>
                                <td id="baixo-psicossociais">0</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>Plano de A√ß√£o - Status</h4>
                    <table id="relatorio-acoes-tabela">
                        <thead>
                            <tr>
                                <th>Status</th>
                                <th>Quantidade</th>
                                <th>Percentual</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Pendente</td>
                                <td id="count-pendente">0</td>
                                <td id="perc-pendente">0%</td>
                            </tr>
                            <tr>
                                <td>Em Progresso</td>
                                <td id="count-progresso">0</td>
                                <td id="perc-progresso">0%</td>
                            </tr>
                            <tr>
                                <td>Conclu√≠do</td>
                                <td id="count-concluido">0</td>
                                <td id="perc-concluido">0%</td>
                            </tr>
                            <tr>
                                <td>Atrasado</td>
                                <td id="count-atrasado">0</td>
                                <td id="perc-atrasado">0%</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- 8. Notifica√ß√µes -->
            <section id="notificacoes" class="content-section">
                <h2>Notifica√ß√µes</h2>
                <p>Receba alertas sobre prazos pr√≥ximos, a√ß√µes pendentes e itens de alto risco.</p>
                <ul class="alert-list" id="notificacoes-list">
                    <!-- Notifica√ß√µes carregadas via JS -->
                </ul>
            </section>

            <!-- 9. Perfis de Usu√°rio -->
            <section id="perfis-usuario" class="content-section">
                <h2>Perfis de Usu√°rio</h2>
                <p>Gerencie os perfis e permiss√µes dos usu√°rios do sistema.</p>
                <p>Esta funcionalidade exigiria um sistema de autentica√ß√£o e autoriza√ß√£o mais complexo, geralmente com um backend.</p>
            </section>
        </main>
    </div>

    <footer>
        <p>&copy; 2025 Sistema de Gest√£o de PGR. Todos os direitos reservados.</p>
    </footer>

    <!-- Link para o arquivo JavaScript -->
    <script src="./app.js"></script>
</body>
</html>
